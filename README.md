# MNU Events Platform

MNU Events — это веб-платформа, разработанная для централизации и упрощения управления мероприятиями в университетской среде. Она представляет собой единое пространство, где студенты, организаторы и администраторы могут взаимодействовать с событиями, клубами и регистрациями.

Проект решает проблему разрозненности информации о мероприятиях, предоставляя удобный и современный интерфейс для всех участников образовательного процесса.

## Функциональные возможности

| Функция | Статус реализации |
|--------|------------------|
| Аутентификация и авторизация | ✅ 100% |
| Управление мероприятиями | ✅ 100% |
| Система регистрации | ✅ 100% |
| Управление клубами | ✅ 100% |
| Отслеживание посещаемости (QR-коды) | ✅ 95% |
| Система оплаты (mock) | ✅ 95% |
| Рынок услуг (товары и услуги) | ✅ 95% |
| Рекламная система | ✅ 95% |
| Аналитика и статистика | ✅ 85% |
| Административная панель | ✅ 95% |
| Мультиязычность (EN, RU, KZ) | ✅ 100% |
| Темная/светлая тема | ✅ 10% |
| Мобильная адаптация | ✅ 100% |

**Всего реализовано:** 92% от запланированного функционала

## Технический стек

### Бэкенд
- **Фреймворк**: NestJS 10 (TypeScript)
- **База данных**: PostgreSQL 15
- **ORM**: Prisma
- **Аутентификация**: JWT (JSON Web Tokens)
- **Авторизация**: Ролевая система (STUDENT, ORGANIZER, ADMIN)
- **API документация**: Swagger/OpenAPI
- **Тестирование**: Jest, SuperTest

### Фронтенд
- **Библиотека**: React 19 (JavaScript)
- **Стилизация**: Tailwind CSS
- **Маршрутизация**: React Router v7
- **Сборщик**: Vite 7
- **UI компоненты**: Собственные + Radix UI
- **Графики**: Recharts
- **Уведомления**: Sonner
- **Иконки**: Lucide React

### Инфраструктура
- **Контейнеризация**: Docker
- **Сервер**: Nginx (фронтенд)
- **CI/CD**: GitHub Actions (планируется)

## Архитектура проекта

### Структура бэкенда
```
backend/src/
├── auth/              # Аутентификация и JWT
├── users/             # Управление пользователями
├── events/            # Управление мероприятиями
├── registrations/     # Регистрации и посещаемость
├── clubs/             # Управление клубами
├── payments/          # Система оплаты (mock)
├── checkin/           # QR-коды и проверка посещений
├── services/          # Рынок услуг
├── analytics/         # Аналитика и статистика
├── prisma/            # ORM и база данных
├── config/            # Конфигурация
└── common/            # Общие утилиты и константы
```

### Структура фронтенда
```
frontend/js/
├── components/        # Переиспользуемые компоненты
│   ├── ui/            # UI компоненты (кнопки, карточки и т.д.)
│   └── layouts/       # Макеты для разных ролей
├── pages/             # Страницы приложения
├── services/          # API сервисы
├── context/           # React контексты
├── utils/             # Утилиты и константы
└── hooks/             # Пользовательские хуки
```

## Инструкции по запуску

### Локальный запуск

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd mnu_events
```

2. Установите зависимости:
```bash
# Установка зависимостей для фронтенда
npm install

# Установка зависимостей для бэкенда
cd backend
npm install
```

3. Настройте переменные окружения:
```bash
# Скопируйте пример файла конфигурации
cp backend/.env.example backend/.env
```

4. Запустите базу данных:
```bash
# В корневой директории проекта
docker-compose up -d postgres
```

5. Запустите миграции и заполнение базы:
```bash
# В директории backend
npx prisma migrate dev
npx prisma generate
npx prisma db seed
```

6. Запустите бэкенд и фронтенд:
```bash
# В директории backend
npm run start:dev

# В новом терминале, в корневой директории
npm run dev
```

### Запуск через Docker

1. Убедитесь, что Docker и Docker Compose установлены

2. Запустите все сервисы:
```bash
./start.sh
```

3. Приложение будет доступно по адресам:
- Фронтенд: http://localhost:3000
- Бэкенд API: http://localhost:3001
- API документация: http://localhost:3001/api

### Тестовые аккаунты

После заполнения базы данных доступны следующие тестовые аккаунты:

- **Администратор**: admin@mnu.edu.kz / admin123
- **Организатор**: organizer@kazguu.kz / Password123!
- **Студент**: student1@kazguu.kz / Password123!

## Структура проекта

```
mnu_events/
├── backend/                 # Серверная часть приложения
│   ├── src/                 # Исходный код
│   ├── prisma/              # Схема базы данных
│   ├── test/                # Тесты
│   ├── .env.example         # Пример файла конфигурации
│   └── package.json         # Зависимости бэкенда
├── frontend/                # Клиентская часть приложения
│   ├── js/                  # Исходный код
│   ├── css/                 # Стили
│   ├── public/              # Публичные ресурсы
│   ├── index.html           # Главная HTML страница
│   └── package.json         # Зависимости фронтенда
├── e2e/                     # E2E тесты
├── docker-compose.yml       # Docker конфигурация
├── docker-compose.prod.yml  # Docker конфигурация для продакшена
├── start.sh                 # Скрипт запуска
├── .env.example             # Пример переменных окружения
├── package.json             # Зависимости корневого уровня
├── README.md                # Документация (этот файл)
├── IMPLEMENTATION_STATUS.md # Статус реализации функций
├── CLAUDE.md               # Руководство для Claude
├── PROJECT_OVERVIEW.md     # Обзор проекта
├── DOCKER_SETUP.md         # Настройка Docker
└── ...
```

## Безопасность и уязвимости

### Текущий статус безопасности
- **Общая оценка**: C (множество критических проблем)
- **OWASP Top 10 оценка**: 
 - A01: Broken Access Control - MEDIUM (ролевые ограничения реализованы, но без детализированного контроля)
  - A02: Cryptographic Failures - CRITICAL (токены localStorage, слабые bcrypt раунды)
  - A03: Injection - GOOD (Prisma ORM эффективно предотвращает SQL-инъекции)
  - A04: Insecure Design - MEDIUM (нет логирования безопасности, нет аудита)
  - A05: Security Misconfiguration - CRITICAL (жестко закодированные секреты, нет CSP заголовков)
  - A06: Vulnerable Components - GOOD (зависимости обновлены)
  - A07: Authentication Failures - MEDIUM (хорошая политика паролей, но без MFA)
  - A08: Data Integrity Failures - MEDIUM (без подписания запросов, без CSRF защиты)
  - A09: Logging Failures - CRITICAL (недостаточное логирование и мониторинг)
  - A10: SSRF - GOOD (нет внешних запросов из пользовательского ввода)

### Критические уязвимости (требуют немедленного устранения)
1. **Жестко закодированные JWT секреты** в примере файла
2. **Хранение токенов в localStorage** (уязвимость XSS)
3. **Отсутствие черного списка JWT токенов**
4. **Проверка базы данных при каждом аутентифицированном запросе**
5. **Отсутствие CSRF защиты**
6. **Отсутствие границ ошибок React**
7. **Слабое хеширование паролей** (10 раундов вместо 12+)
8. **Отсутствие санитизации ввода для XSS**

### Средние уязвимости
1. **Отключенная проверка SSL-сертификатов** в разработке
2. **Отсутствие ограничения скорости** на повторную отправку проверки по электронной почте
3. **Хранение кодов проверки** в виде обычного текста
4. **Конфигурация CORS** позволяет любой источник в разработке

## Статус разработки

**Общий статус**: 82% завершения (по сравнению с 0% в запланированном)

### Фазы реализации:
1. **База данных и миграции** - ✅ 100% завершено
2. **Бэкенд модули** - ✅ 95% завершено
3. **Фронтенд компоненты и HomePage** - ✅ 95% завершено
4. **Платные мероприятия и оплата** - ✅ 95% завершено
5. **QR-система проверки** - ✅ 95% завершено
6. **Аналитика и дашборд** - ✅ 85% завершено
7. **Админ панель доходов** - ⚠️ 60% завершено
8. **Тестирование и полировка** - ⚠️ 50% завершено

### Критические пробелы:
1. **Библиотека Recharts не установлена** (важно для аналитики)
2. **Интеграция навигации по вкладкам** не подключена к HomePage
3. **Интеграция статистики студентов** не подключена к ProfilePage

## Тестирование

### Статус тестирования:
- **Бэкенд покрытие**: <10%
- **Фронтенд покрытие**: <5%
- **E2E тесты**: 4 базовых теста (из планируемых 30+)

### Типы тестов:
- **Модульные тесты**: Jest (настроены, но с низким покрытием)
- **Интеграционные тесты**: Jest + SuperTest
- **E2E тесты**: Playwright
- **Тесты безопасности**: OWASP ZAP (планируется)

### План тестирования:
1. **Модульное тестирование** (цель: 80% покрытия)
2. **Компонентное тестирование** (React Testing Library)
3. **E2E тестирование** (30+ сценариев)
4. **Нагрузочное тестирование** (планируется)
5. **Тестирование безопасности** (планируется)

## Планы и задачи

### Ближайшие задачи:
1. Установить библиотеку Recharts
2. Интегрировать TabNavigation в HomePage
3. Добавить статистику студентов в ProfilePage
4. Создать AdminRevenuePage
5. Добавить E2E тесты для критических потоков

### Долгосрочные задачи:
1. **Фаза 1 (1-2 недели)**: Исправление критических уязвимостей безопасности
2. **Фаза 2 (3-4 недели)**: Добавление инфраструктуры для продакшена (логирование, мониторинг)
3. **Фаза 3 (5-6 недель)**: Достижение 80% покрытия тестами
4. **Фаза 4 (7-8 недель)**: Оптимизация производительности
5. **Фаза 5 (9 неделя)**: Настройка CI/CD
6. **Фаза 6 (10 неделя)**: Аудит безопасности и деплой

### Оценка готовности к продакшену:
- **Архитектура**: B+ (хорошее разделение ответственности)
- **Безопасность**: C (присутствуют критические проблемы)
- **Производительность**: B (хорошие индексы, нужна оптимизация)
- **Инфраструктура продакшена**: D (отсутствуют критические функции)
- **Качество кода**: B+ (хорошая структура, правильный TypeScript)
- **Покрытие тестами**: D (<10% бэкенд, <5% фронтенд)

**Общая оценка готовности**: C+ (70/100) - НЕ ГОТОВО К ПРОДАКШЕНУ
**Требуется времени до готовности**: 8-10 недель (1 разработчик)
